SELECT * FROM tickets LIMIT 100;

SELECT sum(precio_total) as ventas_totales from tickets;

select strftime('%Y-%m',fecha) as mes, sum(precio_total) as ventas_totales 
from tickets 
group by mes 
order by mes;

select id_departamento, sum(precio_total) as ventas_departamento
from tickets
group by id_departamento
order by ventas_departamento desc;

select id_seccion, sum(precio_total) as ventas_departamento
from tickets
group by id_seccion
order by ventas_departamento desc; 

select nombre_producto, sum(cantidad) as ventas_producto
from tickets
group by nombre_producto
order by ventas_producto desc; 

select nombre_producto, sum(precio_total) as mayor_ingreso_producto
from tickets
group by nombre_producto
order by mayor_ingreso_producto desc;

select id_cliente, sum(precio_total) as mayor_comprador
from tickets
group by id_cliente
order by mayor_comprador desc
limit 20;

select AVG(compra_total_cliente) as compra_media_por_cliente
from (
  select id_cliente,sum(precio_total) as compra_total_cliente
  from tickets
  group by id_cliente) subconsulta;

SELECT count(id_pedido) as total_pedidos
from tickets;

SELECT AVG(total_pedido) as valor_promedio_pedido
FROM(
  select id_pedido,sum(precio_total) as total_pedido
  from tickets
  group by id_pedido
  ) subconsulta;
